<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Properties - Ergovia Prestige</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="/logo.png" type="image/png">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="/logo.png" alt="Ergovia" style="width:28px;height:auto;margin-right:4px;">
                <span>Ergovia</span>
            </div>
            <div class="nav-menu">
                <a href="dashboard.html" class="nav-item">
                    <i class="fas fa-th-large"></i>
                    <span>Dashboard</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Settings</span>
                </a>
                <a href="properties.html" class="nav-item active">
                    <i class="fas fa-building"></i>
                    <span>Properties</span>
                </a>
            </div>
            <div class="nav-user">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="notification-bell" id="notificationBell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationCount">0</span>
                </div>
                <div class="user-profile" id="userProfileBtn">
                    <i class="fas fa-user-circle"></i>
                    <span id="userName">Owner</span>
                    <i class="fas fa-chevron-down" style="font-size:11px;color:#a0aec0;"></i>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="user-dropdown-header">
                            <h4 id="dropdownUserName">Owner</h4>
                            <p id="dropdownUserEmail">owner@ergovia.com</p>
                        </div>
                        <a class="user-dropdown-item" href="settings.html"><i class="fas fa-cog"></i> Account Settings</a>
                        <div class="user-dropdown-divider"></div>
                        <button class="user-dropdown-item danger" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Log Out</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Notification Panel (Sidebar) -->
        <div class="notification-panel" id="notificationPanel">
            <div class="notification-header">
                <h3><i class="fas fa-bell"></i> Notifications</h3>
                <button class="btn-close" onclick="closeNotifications()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="notification-list" id="notificationList">
                <!-- Notifications will be loaded here -->
            </div>
        </div>

        <!-- Sync Banner -->
        <div id="syncBanner" style="display:none;align-items:center;gap:12px;padding:14px 20px;margin-bottom:16px;background:linear-gradient(135deg,#1a365d,#2a4a7f);color:#fff;border-radius:10px;font-size:14px;box-shadow:0 2px 8px rgba(26,54,93,0.3);">
        </div>

        <!-- Page Header -->
        <div class="page-header">
            <h1><i class="fas fa-building"></i> My Properties</h1>
            <button class="btn-add" onclick="showAddPropertyModal()">
                <i class="fas fa-plus-circle"></i> Add Property
            </button>
        </div>

        <!-- Properties Grid -->
        <div class="properties-grid" id="propertiesGrid">
            <!-- Properties will be loaded dynamically by JS -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display:none;">
            <i class="fas fa-home-lg-alt"></i>
            <h2>No Properties Yet</h2>
            <p>Add your first property to get started with Ergovia AI</p>
            <button class="btn-add" onclick="showAddPropertyModal()">
                <i class="fas fa-plus-circle"></i> Add Your First Property
            </button>
        </div>
    </div>

    <!-- Add/Edit Property Modal -->
    <div class="modal" id="propertyModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="propertyModalTitle">
                    <i class="fas fa-building"></i> Add New Property
                </h2>
                <span class="modal-close" onclick="closePropertyModal()">&times;</span>
            </div>

            <form id="propertyForm" onsubmit="return handlePropertySubmit(event)">
                <input type="hidden" id="propertyId" name="propertyId">

                <!-- Basic Information -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-info-circle"></i> Basic Information</h3>

                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="propertyName">
                                <i class="fas fa-tag"></i> Property Name
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="propertyName" name="propertyName" required
                                   placeholder="Beach House, Downtown Apartment, etc.">
                        </div>

                        <div class="form-group full-width">
                            <label for="propertyAddress">
                                <i class="fas fa-map-marker-alt"></i> Full Address
                                <span class="required">*</span>
                            </label>
                            <textarea id="propertyAddress" name="propertyAddress" required rows="2"
                                      placeholder="123 Main Street, City, State, ZIP"></textarea>
                        </div>

                        <div class="form-group full-width">
                            <label for="propertyDescription">
                                <i class="fas fa-align-left"></i> Property Description
                            </label>
                            <textarea id="propertyDescription" name="propertyDescription" rows="3"
                                      placeholder="Describe your property â€” location highlights, nearby attractions, what makes it special. The AI will use this when chatting with guests."></textarea>
                            <small class="help-text">The AI concierge uses this to describe your property to guests.</small>
                        </div>

                        <div class="form-group">
                            <label for="propertyType">
                                <i class="fas fa-home"></i> Property Type
                                <span class="required">*</span>
                            </label>
                            <select id="propertyType" name="propertyType" required>
                                <option value="">Select type...</option>
                                <option value="apartment">Apartment</option>
                                <option value="house">House</option>
                                <option value="condo">Condo</option>
                                <option value="villa">Villa</option>
                                <option value="cabin">Cabin</option>
                                <option value="studio">Studio</option>
                                <option value="townhouse">Townhouse</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="numberOfFloors">
                                <i class="fas fa-layer-group"></i> Number of Floors
                            </label>
                            <input type="number" id="numberOfFloors" name="numberOfFloors" min="1" max="10"
                                   placeholder="1">
                        </div>

                        <div class="form-group">
                            <label for="numberOfBedrooms">
                                <i class="fas fa-bed"></i> Bedrooms
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="numberOfBedrooms" name="numberOfBedrooms" required min="0"
                                   placeholder="2">
                        </div>

                        <div class="form-group">
                            <label for="numberOfBathrooms">
                                <i class="fas fa-bath"></i> Bathrooms
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="numberOfBathrooms" name="numberOfBathrooms" required min="0" step="0.5"
                                   placeholder="1.5">
                        </div>

                        <div class="form-group">
                            <label for="maxGuests">
                                <i class="fas fa-users"></i> Maximum Guests
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="maxGuests" name="maxGuests" required min="1"
                                   placeholder="4">
                        </div>

                        <div class="form-group">
                            <label for="squareFeet">
                                <i class="fas fa-ruler-combined"></i> Square Feet
                            </label>
                            <input type="number" id="squareFeet" name="squareFeet"
                                   placeholder="1200">
                        </div>
                    </div>
                </div>

                <!-- Pricing & Stay Rules -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-dollar-sign"></i> Pricing & Stay Rules</h3>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="basePrice">
                                <i class="fas fa-tag"></i> Base Price / Night
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="basePrice" name="basePrice" required min="0" step="0.01"
                                   placeholder="150.00">
                        </div>

                        <div class="form-group">
                            <label for="weekendPrice">
                                <i class="fas fa-calendar-week"></i> Weekend Price / Night
                            </label>
                            <input type="number" id="weekendPrice" name="weekendPrice" min="0" step="0.01"
                                   placeholder="180.00">
                        </div>

                        <div class="form-group">
                            <label for="holidayPrice">
                                <i class="fas fa-gift"></i> Holiday Price / Night
                            </label>
                            <input type="number" id="holidayPrice" name="holidayPrice" min="0" step="0.01"
                                   placeholder="200.00">
                        </div>

                        <div class="form-group">
                            <label for="cleaningFee">
                                <i class="fas fa-broom"></i> Cleaning Fee
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="cleaningFee" name="cleaningFee" required min="0" step="0.01"
                                   placeholder="75.00">
                        </div>

                        <div class="form-group">
                            <label for="minStayNights">
                                <i class="fas fa-moon"></i> Min Stay (nights)
                            </label>
                            <input type="number" id="minStayNights" name="minStayNights" min="1" value="1"
                                   placeholder="1">
                        </div>

                        <div class="form-group">
                            <label for="maxStayNights">
                                <i class="fas fa-moon"></i> Max Stay (nights)
                            </label>
                            <input type="number" id="maxStayNights" name="maxStayNights" min="1" value="30"
                                   placeholder="30">
                        </div>

                        <div class="form-group">
                            <label for="checkInTime">
                                <i class="fas fa-sign-in-alt"></i> Check-in Time
                            </label>
                            <input type="time" id="checkInTime" name="checkInTime" value="15:00">
                        </div>

                        <div class="form-group">
                            <label for="checkOutTime">
                                <i class="fas fa-sign-out-alt"></i> Check-out Time
                            </label>
                            <input type="time" id="checkOutTime" name="checkOutTime" value="11:00">
                        </div>
                    </div>
                </div>

                <!-- Payment Settings -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-credit-card"></i> Payment Settings</h3>

                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="paymentLink">
                                <i class="fas fa-link"></i> Payment Link
                            </label>
                            <input type="url" id="paymentLink" name="paymentLink"
                                   placeholder="https://gcash.com/pay/yourlink or PayPal.me/yourname"
                                   maxlength="500">
                            <small class="help-text">Your GCash, Maya, PayPal, or other payment link. Guests will receive this when booking is confirmed.</small>
                        </div>

                        <div class="form-group full-width">
                            <label for="paymentInstructions">
                                <i class="fas fa-file-invoice-dollar"></i> Payment Instructions
                            </label>
                            <textarea id="paymentInstructions" name="paymentInstructions" rows="3"
                                      placeholder="Bank transfer: BDO Account 1234567890 (Juan Dela Cruz)"
                                      maxlength="1000"></textarea>
                            <small class="help-text">Custom payment instructions if you don't have a payment link. Include bank details, account numbers, etc.</small>
                        </div>
                    </div>
                </div>

                <!-- Calendar & Automation -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-calendar-alt"></i> Calendar & Automation</h3>

                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="calendarUrl">
                                <i class="fab fa-airbnb"></i> Calendar iCal URL
                            </label>
                            <input type="url" id="calendarUrl" name="calendarUrl"
                                   placeholder="https://www.airbnb.com/calendar/ical/...">
                            <small class="help-text">Found in Airbnb &gt; Calendar &gt; Availability &gt; Import/Export</small>
                        </div>

                        <div class="form-group">
                            <label for="timezone">
                                <i class="fas fa-globe-americas"></i> Property Timezone
                                <span class="required">*</span>
                            </label>
                            <select id="timezone" name="timezone">
                                <option value="Asia/Manila">Philippines (Asia/Manila) - UTC+8</option>
                                <option value="Asia/Singapore">Singapore (Asia/Singapore) - UTC+8</option>
                                <option value="Asia/Hong_Kong">Hong Kong (Asia/Hong_Kong) - UTC+8</option>
                                <option value="Asia/Tokyo">Japan (Asia/Tokyo) - UTC+9</option>
                                <option value="Asia/Seoul">South Korea (Asia/Seoul) - UTC+9</option>
                                <option value="Asia/Bangkok">Thailand (Asia/Bangkok) - UTC+7</option>
                                <option value="Asia/Jakarta">Indonesia (Asia/Jakarta) - UTC+7</option>
                                <option value="Asia/Kuala_Lumpur">Malaysia (Asia/Kuala_Lumpur) - UTC+8</option>
                                <option value="Asia/Kolkata">India (Asia/Kolkata) - UTC+5:30</option>
                                <option value="Asia/Dubai">UAE (Asia/Dubai) - UTC+4</option>
                                <option value="Australia/Sydney">Australia Sydney - UTC+10/11</option>
                                <option value="America/New_York">US Eastern - UTC-5/-4</option>
                                <option value="America/Chicago">US Central - UTC-6/-5</option>
                                <option value="America/Denver">US Mountain - UTC-7/-6</option>
                                <option value="America/Los_Angeles">US Pacific - UTC-8/-7</option>
                                <option value="Europe/London">UK (Europe/London) - UTC+0/+1</option>
                                <option value="Europe/Paris">Europe Central (Europe/Paris) - UTC+1/+2</option>
                                <option value="UTC">UTC</option>
                            </select>
                            <small class="help-text">Timezone where your property is located. Used for date/time interpretation.</small>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label" style="margin-top: 28px;">
                                <input type="checkbox" id="calendarSyncEnabled" name="calendarSyncEnabled" value="1" checked>
                                <i class="fas fa-sync"></i> Enable Calendar Sync
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="autoApproveBookings" name="autoApproveBookings" value="1">
                                <i class="fas fa-check-circle"></i> Auto-approve Bookings
                            </label>
                            <small class="help-text">Skip manual confirmation for new bookings</small>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="requireScreening" name="requireScreening" value="1" checked>
                                <i class="fas fa-shield-alt"></i> Require Guest Screening
                            </label>
                            <small class="help-text">AI screens guests before accepting bookings</small>
                        </div>
                    </div>
                </div>

                <!-- Listing Platforms -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-globe"></i> Listing Platforms</h3>

                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="airbnbListingUrl">
                                <i class="fab fa-airbnb"></i> Airbnb Listing URL
                            </label>
                            <input type="url" id="airbnbListingUrl" name="airbnbListingUrl"
                                   placeholder="https://www.airbnb.com/rooms/...">
                        </div>

                        <div class="form-group full-width">
                            <label for="bookingComUrl">
                                <i class="fas fa-hotel"></i> Booking.com URL
                            </label>
                            <input type="url" id="bookingComUrl" name="bookingComUrl"
                                   placeholder="https://www.booking.com/hotel/...">
                        </div>

                        <div class="form-group full-width">
                            <label for="vrboUrl">
                                <i class="fas fa-home"></i> VRBO URL
                            </label>
                            <input type="url" id="vrboUrl" name="vrboUrl"
                                   placeholder="https://www.vrbo.com/...">
                        </div>
                    </div>
                </div>

                <!-- Access & Keys -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-key"></i> Access Information</h3>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="lockType">
                                <i class="fas fa-lock"></i> Lock Type
                            </label>
                            <select id="lockType" name="lockType">
                                <option value="">Select...</option>
                                <option value="keypad">Smart Keypad</option>
                                <option value="lockbox">Lockbox</option>
                                <option value="physical_key">Physical Key</option>
                                <option value="smart_lock">Smart Lock</option>
                                <option value="doorman">Doorman / Concierge</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="doorCode">
                                <i class="fas fa-hashtag"></i> Door Code
                            </label>
                            <input type="text" id="doorCode" name="doorCode"
                                   placeholder="1234 or instructions">
                        </div>

                        <div class="form-group full-width">
                            <label for="accessInstructions">
                                <i class="fas fa-map-signs"></i> Detailed Access Instructions
                            </label>
                            <textarea id="accessInstructions" name="accessInstructions" rows="3"
                                      placeholder="Example: Enter through the side gate, code is 1234. Main door is the blue one on the left."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Property Contacts -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-address-book"></i> Property Contacts</h3>
                    <p class="section-description-small">Who handles specific tasks for this property?</p>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="ownerContact">
                                <i class="fas fa-user-shield"></i> Owner Contact (Chat ID)
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="ownerContact" name="ownerContact"
                                   placeholder="Auto-filled from Owner Info">
                            <small class="help-text">Used for workflow notifications. Defaults to your Telegram Chat ID.</small>
                        </div>

                        <div class="form-group">
                            <label for="ownerTelegram">
                                <i class="fab fa-telegram"></i> Owner Telegram
                            </label>
                            <input type="text" id="ownerTelegram" name="ownerTelegram"
                                   placeholder="Fallback contact">
                        </div>

                        <div class="form-group">
                            <label for="cleanerName">
                                <i class="fas fa-broom"></i> Cleaner Name
                            </label>
                            <input type="text" id="cleanerName" name="cleanerName"
                                   placeholder="Cleaning person's name">
                        </div>

                        <div class="form-group">
                            <label for="cleanerPhone">
                                <i class="fas fa-phone"></i> Cleaner Phone
                            </label>
                            <input type="tel" id="cleanerPhone" name="cleanerPhone"
                                   placeholder="+1234567890">
                        </div>

                        <div class="form-group">
                            <label for="maintenanceName">
                                <i class="fas fa-wrench"></i> Maintenance Contact
                            </label>
                            <input type="text" id="maintenanceName" name="maintenanceName"
                                   placeholder="Maintenance person's name">
                        </div>

                        <div class="form-group">
                            <label for="maintenancePhone">
                                <i class="fas fa-phone"></i> Maintenance Phone
                            </label>
                            <input type="tel" id="maintenancePhone" name="maintenancePhone"
                                   placeholder="+1234567890">
                        </div>

                        <div class="form-group">
                            <label for="onGroundName">
                                <i class="fas fa-user-tie"></i> On-Ground Contact
                            </label>
                            <input type="text" id="onGroundName" name="onGroundName"
                                   placeholder="Local contact person">
                            <small class="help-text">Person who can physically check the property</small>
                        </div>

                        <div class="form-group">
                            <label for="onGroundPhone">
                                <i class="fas fa-phone"></i> On-Ground Phone
                            </label>
                            <input type="tel" id="onGroundPhone" name="onGroundPhone"
                                   placeholder="+1234567890">
                        </div>
                    </div>
                </div>

                <!-- Amenities & Features -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-star"></i> Amenities & Features</h3>

                    <div class="amenities-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_wifi" value="1">
                            <i class="fas fa-wifi"></i> WiFi
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_parking" value="1">
                            <i class="fas fa-parking"></i> Parking
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_pool" value="1">
                            <i class="fas fa-swimming-pool"></i> Pool
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_kitchen" value="1">
                            <i class="fas fa-utensils"></i> Kitchen
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_washer" value="1">
                            <i class="fas fa-tshirt"></i> Washer/Dryer
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_ac" value="1">
                            <i class="fas fa-snowflake"></i> A/C
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_heating" value="1">
                            <i class="fas fa-fire"></i> Heating
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_tv" value="1">
                            <i class="fas fa-tv"></i> TV
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="amenity_petfriendly" value="1">
                            <i class="fas fa-paw"></i> Pet Friendly
                        </label>
                    </div>
                </div>

                <!-- House Rules -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-clipboard-list"></i> House Rules</h3>

                    <div class="form-group full-width">
                        <label for="houseRules">
                            <i class="fas fa-gavel"></i> House Rules
                        </label>
                        <textarea id="houseRules" name="houseRules" rows="4"
                                  placeholder="Example: No smoking indoors. Quiet hours 10pm-8am. No parties. Maximum occupancy must be respected. Pets allowed with prior approval."></textarea>
                        <small class="help-text">The AI will inform guests about these rules during conversation.</small>
                    </div>
                </div>

                <!-- Photos & Media -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-images"></i> Photos & Media</h3>

                    <div class="form-group full-width">
                        <label for="photoUrls">
                            <i class="fas fa-camera"></i> Photo URLs
                        </label>
                        <textarea id="photoUrls" name="photoUrls" rows="3"
                                  placeholder="Paste photo URLs, one per line. Example:&#10;https://example.com/photo1.jpg&#10;https://example.com/photo2.jpg"></textarea>
                        <small class="help-text">The AI can share these photos with guests. One URL per line.</small>
                    </div>
                </div>

                <!-- Special Notes -->
                <div class="form-section-modal">
                    <h3><i class="fas fa-sticky-note"></i> Special Notes</h3>

                    <div class="form-group full-width">
                        <label for="propertyNotes">
                            <i class="fas fa-comment-alt"></i> Property-Specific Notes for AI
                        </label>
                        <textarea id="propertyNotes" name="propertyNotes" rows="4"
                                  placeholder="Example: The WiFi password is posted on the fridge. Parking spot is #7. Remind guests to close windows during rain."></textarea>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closePropertyModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Property
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/config.js"></script>
    <script src="assets/js/auth-guard.js"></script>
    <script src="assets/js/sync.js"></script>
    <script src="assets/js/notifications.js"></script>
    <script src="assets/js/properties.js"></script>
    <script>
        // User dropdown toggle
        document.getElementById('userProfileBtn')?.addEventListener('click', function(e) {
            e.stopPropagation();
            document.getElementById('userDropdown')?.classList.toggle('active');
        });
        document.addEventListener('click', function() {
            document.getElementById('userDropdown')?.classList.remove('active');
        });
        // Logout handler
        document.getElementById('logoutBtn')?.addEventListener('click', function() {
            localStorage.removeItem('ergovia_token');
            localStorage.removeItem('ergovia_user');
            window.location.href = '/login.html';
        });
        // Theme toggle
        (function() {
            const saved = localStorage.getItem('ergovia_theme');
            if (saved === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
            const btn = document.getElementById('themeToggle');
            if (!btn) return;
            function updateIcon() {
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                btn.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            }
            updateIcon();
            btn.addEventListener('click', function() {
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                if (isDark) {
                    document.documentElement.removeAttribute('data-theme');
                    localStorage.setItem('ergovia_theme', 'light');
                } else {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('ergovia_theme', 'dark');
                }
                updateIcon();
            });
        })();
    </script>
</body>
</html>
